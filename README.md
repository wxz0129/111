Markdown
# 📊 研报自动化整理工具 (Windows 小白版指南)

**这是什么？** 这是一个专为金融从业者设计的 Python 自动化工具。它能一键扫描你文件夹里乱七八糟的 PDF 研报和 Excel 模型，识别是哪家公司的，然后自动重命名为标准格式（`券商-公司-标题-日期`），并分门别类归档。

**给谁用？** 完全不懂代码、使用 Windows 系统、想要从手动改名和分类的繁琐工作中解脱出来的你。

---

## 🛠 第一阶段：环境搭建 (只需做一次)

在第一次使用前，你需要给电脑装上“大脑”（Python）和“助手”（插件）。如果你的电脑已经装好环境，可以直接跳到第二阶段。

### 第 1 步：安装 Python
1. **下载**：访问 [Python 官网下载页](https://www.python.org/downloads/)，点击页面上黄色的 **"Download Python 3.x"** 按钮。
2. **安装**：双击运行下载好的安装包。
3. **⚠️ 关键设置（必看）**：在安装界面的底部，**必须勾选** `Add python.exe to PATH` (或者叫 Add Python to environment variables)。
   > **注意**：如果不勾选这个，电脑会找不到 Python，后面的步骤全都会失败！
4. 点击 `Install Now`，等待安装完成。

### 第 2 步：建立工作台
为了让工具正常运行，请在**桌面**（或任意位置）新建一个文件夹，比如叫 `研报整理工作台`。

请确保文件夹里有以下两个内容（缺一不可）：
1. **Investment Research**：新建一个文件夹，名字必须一字不差叫这个。
2. **run.py**：将本项目的代码下载（或复制粘贴到记事本），保存为 `run.py`。

---

### 第 3 步：安装插件 (pdfplumber)
我们需要给 Python 安装一个能读取 PDF 文字的插件。

1. 打开你的 `研报整理工作台` 文件夹。
2. 在文件夹窗口顶部的 **地址栏**（显示路径 `C:\Users\...` 的地方），单击一下，把里面的字全部删掉。
3. 输入 `cmd` 三个字母，然后按键盘上的 **回车键 (Enter)**。
   * *此时屏幕上会弹出一个黑色的命令框。*
4. 在黑框里复制粘贴下面这行命令，然后按回车：
   ```bash
   pip install pdfplumber
等待屏幕上的代码跑完。只要没出现红色的 Error，就说明安装成功了。

▶️ 第二阶段：日常使用 (每次整理时做)
环境搭好后，以后每次需要整理研报，只需要做下面 3 步：

1. 放入文件

把下载好的、文件名混乱的 PDF 或 Excel 报告，全部拖进 Investment Research 文件夹里。

2. 运行工具

同样的方法，在文件夹地址栏输入 cmd 并回车，呼出黑框。

在黑框里输入下面这行命令并回车：

Bash
python run.py
3. 查看结果

屏幕上会显示处理进度（扫描到 xx 份文件...）。

显示 🎉 处理完成 后，文件夹里会自动多出一个 Company_Research_Sorted 文件夹。

点进去，就是整理好的文件了！

个股报告：自动归类到 公司名/报告

模型文件：自动归类到 公司名/模型

行业策略：自动归类到 行业报告

未识别：在 _未分类文件 中（可以手动检查）

🚑 常见问题急救 (Troubleshooting)
Q1: 黑框提示 'python' 不是内部或外部命令？

原因： 第 1 步安装 Python 时，你忘记勾选 Add to PATH 了。 解决： 请卸载 Python，重新运行安装包，盯着那个框把它勾选上，再点安装。

Q2: 黑框提示 ModuleNotFoundError: No module named 'pdfplumber'？

原因： 插件没装好。 解决： 请重新执行第一阶段的 “第 3 步：安装插件”。

Q3: 代码报错 No such file or directory: 'Investment Research'？

原因： 你没有新建 Investment Research 文件夹，或者名字拼错了。 解决： 请检查文件夹名字，必须和代码里的一模一样。

Q4: 我想添加新公司怎么办？

解决： > 1. 右键点击 run.py，选择“用记事本打开”。 2. 找到代码里的 COMPANY_MAP = { 部分。 3. 模仿里面的格式添加新公司，例如："NVDA": "英伟达",。 4. 保存文件 (Ctrl+S) 即可。

Q5: 为什么文件还是原来的名字，没有变？

原因： Windows 默认隐藏了文件后缀名，你可能把代码保存成了 run.py.txt。 解决： 在文件夹顶部点击【查看】-> 勾选【文件扩展名】，把 .txt 删掉，确保它以 .py 结尾。
